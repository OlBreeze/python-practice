# 3. –°—Ç–≤–æ—Ä–∏—Ç–∏ –≥–Ω—É—á–∫–∏–π –º–µ—Ö–∞–Ω—ñ–∑–º –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω–∏—Ö —ñ–≥—Ä–æ–≤–∏—Ö –ø–æ–¥—ñ–π, –Ω–∞–¥–∞—é—á–∏ –¥–µ—Ç–∞–ª—å–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é
# –ø—Ä–æ –ø–æ–¥—ñ—ó, —â–æ –≤—ñ–¥–±—É–ª–∏—Å—è.
# –í–∏–º–æ–≥–∏:
# –°—Ç–≤–æ—Ä–∏—Ç–∏ –∫–ª–∞—Å GameEventException, –Ω–∞—Å—Ç—É–ø–Ω–∏–π –≤—ñ–¥ –±–∞–∑–æ–≤–æ–≥–æ –∫–ª–∞—Å—É.
# –î–æ–¥–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—ñ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç—ñ:
# event_type: —Ä—è–¥–æ–∫, —è–∫–∏–π –æ–ø–∏—Å—É—î —Ç–∏–ø –ø–æ–¥—ñ—ó (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "death", "levelUp").
# details: —Å–ª–æ–≤–Ω–∏–∫ –∞–±–æ –æ–±'—î–∫—Ç, —â–æ –º—ñ—Å—Ç–∏—Ç—å –¥–æ–¥–∞—Ç–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –ø–æ–¥—ñ—ó.
# –ù–∞–ø—Ä–∏–∫–ª–∞–¥:
#
# –î–ª—è –ø–æ–¥—ñ—ó "—Å–º–µ—Ä—Ç—å": –ø—Ä–∏—á–∏–Ω–∞ —Å–º–µ—Ä—Ç—ñ (—É–¥–∞—Ä –º–µ—á–µ–º, –ø–∞–¥—ñ–Ω–Ω—è).
#
# –î–ª—è –ø–æ–¥—ñ—ó "levelUp": –Ω–æ–≤–∏–π —Ä—ñ–≤–µ–Ω—å –ø–µ—Ä—Å–æ–Ω–∞–∂—É, –æ—Ç—Ä–∏–º–∞–Ω—ñ –æ—á–∫–∏ –¥–æ—Å–≤—ñ–¥—É.
#
# –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è:
#
# –ü—ñ—Å–ª—è –∑–∞–∫—ñ–Ω—á–µ–Ω–Ω—è —ñ–≥—Ä–æ–≤–æ—ó –ø–æ–¥—ñ—ó —Å—Ç–≤–æ—Ä—ñ—Ç—å –µ–∫–∑–µ–º–ø–ª—è—Ä GameEventException –∑ —ñ–Ω—à–∏–º–∏ –∑–Ω–∞—á–µ–Ω–Ω—è–º–∏ –≤–ª–∞—Å—Ç–∏–≤–æ—Å—Ç–µ–π.
#
# –í–∏–∫–∏–Ω—É—Ç–∏ —Ü–µ –≤–∏–∫–ª—é—á–µ–Ω–Ω—è –∑ –∫–æ–¥—É –≥—Ä–∏.
#
# –û–±—Ä–æ–±–∫–∞ –≤–∏–∫–ª—é—á–µ–Ω–Ω—è –≤ –∑–∞–≥–∞–ª—å–Ω–æ–º—É –±–ª–æ—Ü—ñ try-catch –∞–±–æ –≤ –±—ñ–ª—å—à —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–æ–º—É –æ–±—Ä–æ–±–Ω–∏–∫—É, —â–æ–± –≤–∏–∫–æ–Ω–∞—Ç–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω—ñ –¥—ñ—ó
# (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø–æ–∫–∞–∑–∞—Ç–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–µ–≤—ñ, –∑–±–µ—Ä–µ–≥—Ç–∏ –¥–∞–Ω—ñ –ø—Ä–æ –ø–æ–¥—ñ—ó).
# 4. –°—Ç–≤–æ—Ä–∏—Ç–∏ –º–µ—Ö–∞–Ω—ñ–∑–º –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —Å–∏—Ç—É–∞—Ü—ñ–π, –∫–æ–ª–∏ –≥—Ä–∞–≤–µ—Ü—é –Ω–µ –≤–∏—Å—Ç–∞—á–∞—î —Ä–µ—Å—É—Ä—Å—ñ–≤ –¥–ª—è –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥—ñ–π.

from typing import Dict, Any, Union, Optional
from enum import Enum
import logging


class EventType(Enum):
    """–ü–µ—Ä–µ–ª—ñ–∫ —Ç–∏–ø—ñ–≤ —ñ–≥—Ä–æ–≤–∏—Ö –ø–æ–¥—ñ–π."""
    DEATH = "death"
    LEVEL_UP = "levelUp"
    ITEM_FOUND = "itemFound"
    QUEST_COMPLETED = "questCompleted"
    ACHIEVEMENT_UNLOCKED = "achievementUnlocked"
    BATTLE_WON = "battleWon"
    BATTLE_LOST = "battleLost"


class ResourceType(Enum):
    """–ü–µ—Ä–µ–ª—ñ–∫ —Ç–∏–ø—ñ–≤ —Ä–µ—Å—É—Ä—Å—ñ–≤ —É –≥—Ä—ñ."""
    HEALTH = "health"
    MANA = "mana"
    GOLD = "gold"
    EXPERIENCE = "experience"
    STAMINA = "stamina"
    ENERGY = "energy"


class GameEventException(Exception):
    """
    –í–∏–∫–ª—é—á–µ–Ω–Ω—è –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —Ä—ñ–∑–Ω–æ–º–∞–Ω—ñ—Ç–Ω–∏—Ö —ñ–≥—Ä–æ–≤–∏—Ö –ø–æ–¥—ñ–π.

    –¶–µ –≤–∏–∫–ª—é—á–µ–Ω–Ω—è –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –ø–µ—Ä–µ–¥–∞—á—ñ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó –ø—Ä–æ —ñ–≥—Ä–æ–≤—ñ –ø–æ–¥—ñ—ó
    —á–µ—Ä–µ–∑ –º–µ—Ö–∞–Ω—ñ–∑–º –≤–∏–Ω—è—Ç–∫—ñ–≤, –¥–æ–∑–≤–æ–ª—è—é—á–∏ —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ –æ–±—Ä–æ–±–ª—è—Ç–∏ –≤—Å—ñ —ñ–≥—Ä–æ–≤—ñ –ø–æ–¥—ñ—ó.
    """

    def __init__(
            self,
            event_type: Union[str, EventType],
            details: Optional[Dict[str, Any]] = None,
            message: Optional[str] = None
    ) -> None:
        """
        –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î –Ω–æ–≤–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä GameEventException.

        Args:
            event_type: –¢–∏–ø –ø–æ–¥—ñ—ó (—Ä—è–¥–æ–∫ –∞–±–æ EventType enum)
            details: –°–ª–æ–≤–Ω–∏–∫ –∑ –¥–æ–¥–∞—Ç–∫–æ–≤–æ—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ –ø–æ–¥—ñ—é
            message: –ü–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–¥—ñ—é (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
        """
        self.event_type = event_type.value if isinstance(event_type, EventType) else event_type
        self.details = details or {}

        # –§–æ—Ä–º—É—î–º–æ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ, —è–∫—â–æ –≤–æ–Ω–æ –Ω–µ –Ω–∞–¥–∞–Ω–µ
        if message is None:
            message = self._generate_message()

        super().__init__(message)

    def _generate_message(self) -> str:
        """
        –ì–µ–Ω–µ—Ä—É—î –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –Ω–∞ –æ—Å–Ω–æ–≤—ñ —Ç–∏–ø—É –ø–æ–¥—ñ—ó —Ç–∞ –¥–µ—Ç–∞–ª–µ–π.

        Returns:
            –°—Ñ–æ—Ä–º–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –ø–æ–¥—ñ—é
        """
        base_message = f"–Ü–≥—Ä–æ–≤–∞ –ø–æ–¥—ñ—è: {self.event_type}"

        if self.details:
            details_str = ", ".join([f"{key}: {value}" for key, value in self.details.items()])
            return f"{base_message} ({details_str})"

        return base_message

    def get_event_info(self) -> Dict[str, Any]:
        """
        –ü–æ–≤–µ—Ä—Ç–∞—î –ø–æ–≤–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –ø–æ–¥—ñ—é.

        Returns:
            –°–ª–æ–≤–Ω–∏–∫ –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ –ø–æ–¥—ñ—é
        """
        return {
            "event_type": self.event_type,
            "details": self.details,
            "message": str(self),
            "timestamp": None  # –ú–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ —Ä–µ–∞–ª—å–Ω–∏–π —á–∞—Å
        }


class InsufficientResourcesException(Exception):
    """
    –í–∏–∫–ª—é—á–µ–Ω–Ω—è –¥–ª—è –æ–±—Ä–æ–±–∫–∏ —Å–∏—Ç—É–∞—Ü—ñ–π –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—ñ—Ö —Ä–µ—Å—É—Ä—Å—ñ–≤.

    –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –∫–æ–ª–∏ –≥—Ä–∞–≤–µ—Ü—å –Ω–∞–º–∞–≥–∞—î—Ç—å—Å—è –≤–∏–∫–æ–Ω–∞—Ç–∏ –¥—ñ—é,
    –¥–ª—è —è–∫–æ—ó —É –Ω—å–æ–≥–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Ä–µ—Å—É—Ä—Å—ñ–≤.
    """

    def __init__(
            self,
            resource_type: Union[str, ResourceType],
            required_amount: Union[int, float],
            current_amount: Union[int, float],
            action: Optional[str] = None
    ) -> None:
        """
        –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î –Ω–æ–≤–∏–π –µ–∫–∑–µ–º–ø–ª—è—Ä InsufficientResourcesException.

        Args:
            resource_type: –¢–∏–ø —Ä–µ—Å—É—Ä—Å—É, —è–∫–æ–≥–æ –Ω–µ –≤–∏—Å—Ç–∞—á–∞—î
            required_amount: –ù–µ–æ–±—Ö—ñ–¥–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–µ—Å—É—Ä—Å—É
            current_amount: –ü–æ—Ç–æ—á–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å —Ä–µ—Å—É—Ä—Å—É
            action: –î—ñ—è, —è–∫—É –Ω–∞–º–∞–≥–∞–≤—Å—è –≤–∏–∫–æ–Ω–∞—Ç–∏ –≥—Ä–∞–≤–µ—Ü—å (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
        """
        self.resource_type = resource_type.value if isinstance(resource_type, ResourceType) else resource_type
        self.required_amount = required_amount
        self.current_amount = current_amount
        self.deficit = required_amount - current_amount
        self.action = action

        message = self._generate_message()
        super().__init__(message)

    def _generate_message(self) -> str:
        """
        –ì–µ–Ω–µ—Ä—É—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –Ω–µ—Å—Ç–∞—á—É —Ä–µ—Å—É—Ä—Å—ñ–≤.

        Returns:
            –°—Ñ–æ—Ä–º–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø—Ä–æ –Ω–µ—Å—Ç–∞—á—É —Ä–µ—Å—É—Ä—Å—ñ–≤
        """
        base_message = (f"–ù–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ —Ä–µ—Å—É—Ä—Å—É '{self.resource_type}': "
                        f"–ø–æ—Ç—Ä—ñ–±–Ω–æ {self.required_amount}, "
                        f"—î {self.current_amount} "
                        f"(–Ω–µ –≤–∏—Å—Ç–∞—á–∞—î {self.deficit})")

        if self.action:
            return f"{base_message}. –î—ñ—è: {self.action}"

        return base_message

    def get_resource_info(self) -> Dict[str, Any]:
        """
        –ü–æ–≤–µ—Ä—Ç–∞—î –ø–æ–≤–Ω—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –Ω–µ—Å—Ç–∞—á—É —Ä–µ—Å—É—Ä—Å—É.

        Returns:
            –°–ª–æ–≤–Ω–∏–∫ –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ —Ä–µ—Å—É—Ä—Å
        """
        return {
            "resource_type": self.resource_type,
            "required_amount": self.required_amount,
            "current_amount": self.current_amount,
            "deficit": self.deficit,
            "action": self.action
        }


class GameEventHandler:
    """
    –ö–ª–∞—Å –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–æ—ó –æ–±—Ä–æ–±–∫–∏ —ñ–≥—Ä–æ–≤–∏—Ö –ø–æ–¥—ñ–π.

    –ó–∞–±–µ–∑–ø–µ—á—É—î –ª–æ–≥—É–≤–∞–Ω–Ω—è –ø–æ–¥—ñ–π —Ç–∞ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –¥–æ–¥–∞–≤–∞–Ω–Ω—è
    –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫–∏—Ö –æ–±—Ä–æ–±–Ω–∏–∫—ñ–≤ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –ø–æ–¥—ñ–π.
    """

    def __init__(self) -> None:
        """–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î –æ–±—Ä–æ–±–Ω–∏–∫ —ñ–≥—Ä–æ–≤–∏—Ö –ø–æ–¥—ñ–π."""
        self.logger = logging.getLogger(__name__)
        self._event_handlers: Dict[str, list] = {}
        self._setup_logging()

    def _setup_logging(self) -> None:
        """–ù–∞–ª–∞—à—Ç–æ–≤—É—î –ª–æ–≥—É–≤–∞–Ω–Ω—è –¥–ª—è —ñ–≥—Ä–æ–≤–∏—Ö –ø–æ–¥—ñ–π."""
        if not self.logger.handlers:
            handler = logging.StreamHandler()
            formatter = logging.Formatter(
                '%(asctime)s - %(name)s - %(levelname)s - %(message)s'
            )
            handler.setFormatter(formatter)
            self.logger.addHandler(handler)
            self.logger.setLevel(logging.INFO)

    def add_event_handler(self, event_type: str, handler_func) -> None:
        """
        –î–æ–¥–∞—î –æ–±—Ä–æ–±–Ω–∏–∫ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ç–∏–ø—É –ø–æ–¥—ñ—ó.

        Args:
            event_type: –¢–∏–ø –ø–æ–¥—ñ—ó
            handler_func: –§—É–Ω–∫—Ü—ñ—è-–æ–±—Ä–æ–±–Ω–∏–∫
        """
        if event_type not in self._event_handlers:
            self._event_handlers[event_type] = []
        self._event_handlers[event_type].append(handler_func)

    def handle_game_event(self, exception: GameEventException) -> None:
        """
        –û–±—Ä–æ–±–ª—è—î —ñ–≥—Ä–æ–≤—É –ø–æ–¥—ñ—é.

        Args:
            exception: –ï–∫–∑–µ–º–ø–ª—è—Ä GameEventException
        """
        event_info = exception.get_event_info()

        # –õ–æ–≥—É—î–º–æ –ø–æ–¥—ñ—é
        self.logger.info(f"–û–±—Ä–æ–±–∫–∞ –ø–æ–¥—ñ—ó: {exception}")

        # –í–∏–∫–ª–∏–∫–∞—î–º–æ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ü—å–∫—ñ –æ–±—Ä–æ–±–Ω–∏–∫–∏
        if exception.event_type in self._event_handlers:
            for handler in self._event_handlers[exception.event_type]:
                try:
                    handler(event_info)
                except Exception as e:
                    self.logger.error(f"–ü–æ–º–∏–ª–∫–∞ –≤ –æ–±—Ä–æ–±–Ω–∏–∫—É –ø–æ–¥—ñ—ó: {e}")

    def handle_resource_exception(self, exception: InsufficientResourcesException) -> None:
        """
        –û–±—Ä–æ–±–ª—è—î –≤–∏–∫–ª—é—á–µ–Ω–Ω—è –Ω–µ—Å—Ç–∞—á—ñ —Ä–µ—Å—É—Ä—Å—ñ–≤.

        Args:
            exception: –ï–∫–∑–µ–º–ø–ª—è—Ä InsufficientResourcesException
        """
        resource_info = exception.get_resource_info()

        # –õ–æ–≥—É—î–º–æ –Ω–µ—Å—Ç–∞—á—É —Ä–µ—Å—É—Ä—Å—ñ–≤
        self.logger.warning(f"–ù–µ—Å—Ç–∞—á–∞ —Ä–µ—Å—É—Ä—Å—ñ–≤: {exception}")

        # –¢—É—Ç –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –ª–æ–≥—ñ–∫—É –¥–ª—è –≤—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è –∞–±–æ –ø—Ä–æ–ø–æ–∑–∏—Ü—ñ—ó –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤


# –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
class GameSimulator:
    """
    –°–∏–º—É–ª—è—Ç–æ—Ä –≥—Ä–∏ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—ó —Ä–æ–±–æ—Ç–∏ –∑ –ø–æ–¥—ñ—è–º–∏ —Ç–∞ —Ä–µ—Å—É—Ä—Å–∞–º–∏.
    """

    def __init__(self) -> None:
        """–Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑—É—î —Å–∏–º—É–ª—è—Ç–æ—Ä –≥—Ä–∏."""
        self.event_handler = GameEventHandler()
        self.player_resources = {
            ResourceType.HEALTH.value: 100,
            ResourceType.MANA.value: 50,
            ResourceType.GOLD.value: 25,
            ResourceType.EXPERIENCE.value: 1500
        }
        self.player_level = 5

        # –î–æ–¥–∞—î–º–æ –æ–±—Ä–æ–±–Ω–∏–∫–∏ –ø–æ–¥—ñ–π
        self._setup_event_handlers()

    def _setup_event_handlers(self) -> None:
        """–ù–∞–ª–∞—à—Ç–æ–≤—É—î –æ–±—Ä–æ–±–Ω–∏–∫–∏ –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤ –ø–æ–¥—ñ–π."""

        def handle_death(event_info: Dict[str, Any]) -> None:
            print(f"üíÄ –ì—Ä–∞–≤–µ—Ü—å –∑–∞–≥–∏–Ω—É–≤! –ü—Ä–∏—á–∏–Ω–∞: {event_info['details'].get('cause', '–ù–µ–≤—ñ–¥–æ–º–∞')}")

        def handle_level_up(event_info: Dict[str, Any]) -> None:
            print(f"üéâ –ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è —Ä—ñ–≤–Ω—è –¥–æ {event_info['details'].get('new_level', 'N/A')}!")

        def handle_item_found(event_info: Dict[str, Any]) -> None:
            item_name = event_info['details'].get('item_name', '–ù–µ–≤—ñ–¥–æ–º–∏–π –ø—Ä–µ–¥–º–µ—Ç')
            print(f"‚ú® –ó–Ω–∞–π–¥–µ–Ω–æ –ø—Ä–µ–¥–º–µ—Ç: {item_name}")

        self.event_handler.add_event_handler(EventType.DEATH.value, handle_death)
        self.event_handler.add_event_handler(EventType.LEVEL_UP.value, handle_level_up)
        self.event_handler.add_event_handler(EventType.ITEM_FOUND.value, handle_item_found)

    def player_dies(self, cause: str = "–ù–µ–≤—ñ–¥–æ–º–∞ –ø—Ä–∏—á–∏–Ω–∞") -> None:
        """
        –°–∏–º—É–ª—é—î —Å–º–µ—Ä—Ç—å –≥—Ä–∞–≤—Ü—è.

        Args:
            cause: –ü—Ä–∏—á–∏–Ω–∞ —Å–º–µ—Ä—Ç—ñ
        """
        try:
            raise GameEventException(
                event_type=EventType.DEATH,
                details={
                    "cause": cause,
                    "location": "–¢–µ–º–Ω–∏–π –ª—ñ—Å",
                    "level_lost": self.player_level
                }
            )
        except GameEventException as e:
            self.event_handler.handle_game_event(e)

    def player_levels_up(self, experience_gained: int) -> None:
        """
        –°–∏–º—É–ª—é—î –ø—ñ–¥–≤–∏—â–µ–Ω–Ω—è —Ä—ñ–≤–Ω—è –≥—Ä–∞–≤—Ü—è.

        Args:
            experience_gained: –ö—ñ–ª—å–∫—ñ—Å—Ç—å –æ—Ç—Ä–∏–º–∞–Ω–æ–≥–æ –¥–æ—Å–≤—ñ–¥—É
        """
        try:
            self.player_level += 1
            raise GameEventException(
                event_type=EventType.LEVEL_UP,
                details={
                    "new_level": self.player_level,
                    "experience_gained": experience_gained,
                    "total_experience": self.player_resources[ResourceType.EXPERIENCE.value] + experience_gained
                }
            )
        except GameEventException as e:
            self.event_handler.handle_game_event(e)

    def find_item(self, item_name: str, item_value: int) -> None:
        """
        –°–∏–º—É–ª—é—î –∑–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –ø—Ä–µ–¥–º–µ—Ç—É.

        Args:
            item_name: –ù–∞–∑–≤–∞ –ø—Ä–µ–¥–º–µ—Ç—É
            item_value: –í–∞—Ä—Ç—ñ—Å—Ç—å –ø—Ä–µ–¥–º–µ—Ç—É
        """
        try:
            raise GameEventException(
                event_type=EventType.ITEM_FOUND,
                details={
                    "item_name": item_name,
                    "item_value": item_value,
                    "rarity": "Epic" if item_value > 100 else "Common"
                }
            )
        except GameEventException as e:
            self.event_handler.handle_game_event(e)

    def cast_spell(self, mana_cost: int, spell_name: str) -> None:
        """
        –°–∏–º—É–ª—é—î –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–∞–∫–ª–∏–Ω–∞–Ω–Ω—è.

        Args:
            mana_cost: –í–∞—Ä—Ç—ñ—Å—Ç—å –∑–∞–∫–ª–∏–Ω–∞–Ω–Ω—è –≤ –º–∞–Ω—ñ
            spell_name: –ù–∞–∑–≤–∞ –∑–∞–∫–ª–∏–Ω–∞–Ω–Ω—è
        """
        current_mana = self.player_resources[ResourceType.MANA.value]

        if current_mana < mana_cost:
            try:
                raise InsufficientResourcesException(
                    resource_type=ResourceType.MANA,
                    required_amount=mana_cost,
                    current_amount=current_mana,
                    action=f"–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–∞–∫–ª–∏–Ω–∞–Ω–Ω—è '{spell_name}'"
                )
            except InsufficientResourcesException as e:
                self.event_handler.handle_resource_exception(e)
                print(f"‚ùå –ù–µ –≤–¥–∞–ª–æ—Å—è –≤–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –∑–∞–∫–ª–∏–Ω–∞–Ω–Ω—è '{spell_name}'")
        else:
            self.player_resources[ResourceType.MANA.value] -= mana_cost
            print(f"‚úÖ –ó–∞–∫–ª–∏–Ω–∞–Ω–Ω—è '{spell_name}' —É—Å–ø—ñ—à–Ω–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–æ! "
                  f"–ó–∞–ª–∏—à–∏–ª–æ—Å—å –º–∞–Ω–∏: {self.player_resources[ResourceType.MANA.value]}")

    def buy_item(self, item_cost: int, item_name: str) -> None:
        """
        –°–∏–º—É–ª—é—î –ø–æ–∫—É–ø–∫—É –ø—Ä–µ–¥–º–µ—Ç—É.

        Args:
            item_cost: –í–∞—Ä—Ç—ñ—Å—Ç—å –ø—Ä–µ–¥–º–µ—Ç—É
            item_name: –ù–∞–∑–≤–∞ –ø—Ä–µ–¥–º–µ—Ç—É
        """
        current_gold = self.player_resources[ResourceType.GOLD.value]

        if current_gold < item_cost:
            try:
                raise InsufficientResourcesException(
                    resource_type=ResourceType.GOLD,
                    required_amount=item_cost,
                    current_amount=current_gold,
                    action=f"–ü–æ–∫—É–ø–∫–∞ –ø—Ä–µ–¥–º–µ—Ç—É '{item_name}'"
                )
            except InsufficientResourcesException as e:
                self.event_handler.handle_resource_exception(e)
                print(f"üí∞ –ù–µ –≤–¥–∞–ª–æ—Å—è –∫—É–ø–∏—Ç–∏ '{item_name}' - –Ω–µ –≤–∏—Å—Ç–∞—á–∞—î –∑–æ–ª–æ—Ç–∞!")
        else:
            self.player_resources[ResourceType.GOLD.value] -= item_cost
            print(f"üõçÔ∏è –ü—Ä–µ–¥–º–µ—Ç '{item_name}' —É—Å–ø—ñ—à–Ω–æ –∫—É–ø–ª–µ–Ω–æ! "
                  f"–ó–∞–ª–∏—à–∏–ª–æ—Å—å –∑–æ–ª–æ—Ç–∞: {self.player_resources[ResourceType.GOLD.value]}")


def demonstrate_game_events() -> None:
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è —Ä–æ–±–æ—Ç–∏ —Å–∏—Å—Ç–µ–º–∏ —ñ–≥—Ä–æ–≤–∏—Ö –ø–æ–¥—ñ–π."""
    print("=== –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è —Å–∏—Å—Ç–µ–º–∏ —ñ–≥—Ä–æ–≤–∏—Ö –ø–æ–¥—ñ–π ===\n")

    game = GameSimulator()

    print(f"–ü–æ—á–∞—Ç–∫–æ–≤—ñ —Ä–µ—Å—É—Ä—Å–∏ –≥—Ä–∞–≤—Ü—è: {game.player_resources}")
    print(f"–†—ñ–≤–µ–Ω—å –≥—Ä–∞–≤—Ü—è: {game.player_level}\n")

    # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü—ñ—è —Ä—ñ–∑–Ω–∏—Ö –ø–æ–¥—ñ–π
    print("1. –°–º–µ—Ä—Ç—å –≥—Ä–∞–≤—Ü—è:")
    game.player_dies("–£–¥–∞—Ä –¥—Ä–∞–∫–æ–Ω—è—á–æ–≥–æ –≤–æ–≥–Ω—é")

    print("\n2. –ü—ñ–¥–≤–∏—â–µ–Ω–Ω—è —Ä—ñ–≤–Ω—è:")
    game.player_levels_up(500)

    print("\n3. –ó–Ω–∞—Ö–æ–¥–∂–µ–Ω–Ω—è –ø—Ä–µ–¥–º–µ—Ç—É:")
    game.find_item("–ú–µ—á –¥—Ä–∞–∫–æ–Ω–æ–±—ñ–π—Ü—è", 150)

    print("\n4. –£—Å–ø—ñ—à–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–∞–∫–ª–∏–Ω–∞–Ω–Ω—è:")
    game.cast_spell(30, "–í–æ–≥–Ω—è–Ω–∞ –∫—É–ª—è")

    print("\n5. –ù–µ—É—Å–ø—ñ—à–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –∑–∞–∫–ª–∏–Ω–∞–Ω–Ω—è (–Ω–µ –≤–∏—Å—Ç–∞—á–∞—î –º–∞–Ω–∏):")
    game.cast_spell(25, "–ë–ª–∏—Å–∫–∞–≤–∫–∞")

    print("\n6. –£—Å–ø—ñ—à–Ω–∞ –ø–æ–∫—É–ø–∫–∞:")
    game.buy_item(20, "–ó—ñ–ª–ª—è –∑–¥–æ—Ä–æ–≤'—è")

    print("\n7. –ù–µ—É—Å–ø—ñ—à–Ω–∞ –ø–æ–∫—É–ø–∫–∞ (–Ω–µ –≤–∏—Å—Ç–∞—á–∞—î –∑–æ–ª–æ—Ç–∞):")
    game.buy_item(10, "–ú–∞–≥—ñ—á–Ω–∏–π –µ–ª—ñ–∫—Å–∏—Ä")

    print(f"\n–§—ñ–Ω–∞–ª—å–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏ –≥—Ä–∞–≤—Ü—è: {game.player_resources}")
    print(f"–§—ñ–Ω–∞–ª—å–Ω–∏–π —Ä—ñ–≤–µ–Ω—å –≥—Ä–∞–≤—Ü—è: {game.player_level}")


if __name__ == "__main__":
    demonstrate_game_events()